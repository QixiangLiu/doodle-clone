<!DOCTYPE html>
<html>
  <head>
    <title>Time Data Template</title>
  </head>
  <script src="data1.js"></script>
  <script src="require.js"></script>
  <body>

    <h1>Testing:</h1>
    <!-- This is a simple html file and I can run you through the basics of everything here later -->

    <!-- The "return runChecks()" on line 12 runs your JavaScript tests when you submit code-->
    <!-- For now, just know that between here ... -->

    <script type="text/JavaScript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script type="text/javascript">
        var fs = require(["fs"]);
//GET https://sheets.googleapis.com/v4/spreadsheets/spreadsheetId?ranges=A1:A1&fields=sheets(sheetProperties,data.rowData.values(effectiveValue,effectiveFormat))
        fs.readFile('dataStorage.txt', 'utf8', function(err, data)
        {
            if (err) throw err;
            console.log(data);
        });

    // TODO:
        //  writeFromCSV() goes HERE!!!!
        //  also will need something on this page similar to onclose="writeToCSV()"
        //readFromFile();

        //The below variable will be equal to the OBJECT that JSON.parse() returns.
        //Uncomment line 24 when we are able to pass in the string from the file.

        //var inString = {"meetings":[{"name":"Christmas","date":"2005-12-24","creator":"Huff","stime":"05:05","etime":"06:05","timeSlots":[],"numTimeSlots":3,"attendees":[{"firstname":"Huff","lastname":""}],"numAttend":1,"totalMins":60}],"numMeetings":1,"knownPersons":[{"firstname":"Huff","lastname":""}],"numPersons":1};
        //var inDriver = JSON.parse(inString);
        //var inDriver = JSON.parse("{"meetings":[{"name":"Christmas Eve","date":"2005-12-24","creator":"Huff","stime":"05:05","etime":"06:05","timeSlots":[],"numTimeSlots":3,"attendees":[{"firstname":"Huff","lastname":""}],"numAttend":1,"totalMins":60}],"numMeetings":1,"knownPersons":[{"firstname":"Huff","lastname":""}],"numPersons":1}");
        var inputFile = "dataStorage.txt";
        var inDriver = 1;
        if(inDriver != null) // If inDriver is null it will create the first driver. else it will assign driver to JSON.parse() return value(object)
        {
            var driver =
            {
                meetings    : [],
                numMeetings : 0,
                knownPersons: [],
                numPersons  : 0,
                addMeeting  : function()
                {
                    var meeting =
                    {
                         name:event_name,
                         date:date,
                         creator:creator,
                         stime:stime,
                         etime:etime,
                         timeSlots:[],
                         numTimeSlots:0,
                         attendees:[],
                         numAttend:1
                    };

                    var timeslot =
                    {
                        tsStime:"12:00",
                        tsEtime:"12:20",
                        attendees:[],//if person is in this array, they are available for this timeslot in the meeting
                        numAttendees:0
                    };


                    var startHr = Number(stime.slice(0, 2));
                    var startMin = Number(stime.slice(3, 5));
                    var endHr = Number(etime.slice(0, 2));
                    var endMin = Number(etime.slice(3, 5));
                    console.log(startHr, startMin, endHr, endMin);

                    meeting.totalMins = (((endHr - startHr) * 60) + (endMin - startMin));
                    console.log(meeting.totalMins);
                    meeting.numTimeSlots = ( meeting.totalMins / 20 );
                    console.log("TimeSlots = " + meeting.numTimeSlots);

                    this.meetings.push(meeting);

                    console.log("Preparing to enter dupPersons(html:58) *DBG");

                    if(!dupPersons())
                    {
                        //creates a person for the driver's knownPersons array.
                        var person =
                        {
                             firstname:creator,
                             lastname:""
                        };
                        console.log("Attempting to log the person");
                        console.log(person.firstname);
                        this.knownPersons.push(person);
                        console.log(person.firstname + "Added to knownPersons[] *DBG");
                        this.numPersons++;
                        this.meetings[this.numMeetings].attendees.push(person);
                        this.numMeetings++;
                    }
                    else
                    {
                        this.meetings[this.numMeetings].attendees.push(person);
                        this.numMeetings++;
                    }



                    return (true);

                }

            }
        }
        else
        {
            var driver = inDriver;
        }
        //run updateData() method to populate driver object from file
    </script>
    <!-- TODO: onclick get all values and pass on as parameters -->
    <!--document.getElementByName("eventMaker".xyz) -->

    <form onsubmit="eventSubmit();" name="eventMaker">
      <input type="text" name="admin" placeholder="Admin Name">
      <input type="text" name="event" placeholder="Event Name">
      <input type="date" name="date">
      <input type="time" name="stime" placeholder="Start Time">
      <input type="time" name="etime" placeholder="End Time">
      <br>
      <button type="button" onclick="eventSubmit();console.log(driver.numMeetings);">Create Event</button>

      <!--<input type="submit" action=""> action specifies destination.-->
    </form>
    <!-- ... and here, is the code that receives data from the user and hands it to the Javascript file -->

  </body>
</html>
